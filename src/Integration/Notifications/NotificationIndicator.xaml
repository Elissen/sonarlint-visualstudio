<UserControl x:Class="SonarLint.VisualStudio.Integration.Notifications.NotificationIndicator"
             x:Name="UserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:SonarLint.VisualStudio.Integration.Notifications"
             xmlns:integration="clr-namespace:SonarLint.VisualStudio.Integration.WPF">
    <UserControl.Resources>
        <integration:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <ControlTemplate x:Key="ImageButtonTemplate">
            <Grid>
                <Border x:Name="PART_Border" BorderBrush="Gray" Width="16" Height="16"
                        BorderThickness="3" Background="White" />
            </Grid>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding HasEvents}" Value="True">
                    <Setter Value="Red" Property="BorderBrush" TargetName="PART_Border"  />
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <ControlTemplate x:Key="LinkButtonTemplate">
            <TextBlock>
                <Hyperlink>Show more</Hyperlink>
            </TextBlock>
        </ControlTemplate>
    </UserControl.Resources>
    <UserControl.Visibility>
        <Binding Path="IsVisible" Converter="{StaticResource BoolToVisibilityConverter}"/>
    </UserControl.Visibility>
    <Grid>
        <ToggleButton x:Name="PART_Button" ClickMode="Press" Template="{StaticResource ImageButtonTemplate}" />

        <Popup IsOpen="{Binding IsChecked, ElementName=PART_Button, Mode=TwoWay}"
               PlacementTarget="{Binding ElementName=PART_Button}"
               Placement="Top" StaysOpen="False" PopupAnimation="Fade">
            <Grid>
                <Border BorderThickness="1" BorderBrush="#7097B5" Background="#80333333" Width="360" Height="80" />
                <TextBlock Text="{Binding BalloonTipText}" TextWrapping="Wrap" Margin="10,10,23,20" Foreground="Gray" />
                <Button Command="{Binding ShowDetailsCommand}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="3"
                        Template="{StaticResource LinkButtonTemplate}" />
                <Button Width="15" Height="15" Padding="0,-2,0,0" Margin="5"
                        HorizontalAlignment="Right" VerticalAlignment="Top"
                        Background="Transparent" Foreground="#909090" FontWeight="Bold"
                        BorderThickness="0"
                        Click="Close_Click">X</Button>
            </Grid>
        </Popup>
    </Grid>
</UserControl>
